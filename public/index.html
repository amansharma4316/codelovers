<!DOCTYPE html>
<html>

<head>
    <title>HTML to DOCX Converter</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        
        h1 {
            background-color: #3498db;
            color: #fff;
            padding: 20px;
        }
        
        #htmlFileInput {
            display: block;
            margin: 20px auto;
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 5px;
            background-color: #fff;
        }
        
        #convertButton {
            background-color: #3498db;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #convertButton:hover {
            background-color: #2185d0;
        }
        
        #downloadLink {
            display: none;
            background-color: #27ae60;
            color: #fff;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            margin: 20px;
        }
        
        #htmlContent {
            display: none;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            margin: 20px;
        }
    </style>
</head>

<body>
    <h1>HTML to DOCX Converter</h1>
    <input type="file" id="htmlFileInput" accept=".html">
    <button id="convertButton">Convert to DOCX</button>
    <a id="downloadLink" style="display: none;">Download DOCX</a>

    <script>
        document.getElementById('convertButton').addEventListener('click', function() {
            const htmlFileInput = document.getElementById('htmlFileInput');
            const downloadLink = document.getElementById('downloadLink');
            const htmlContentDiv = document.getElementById('htmlContent');

            const file = htmlFileInput.files[0];

            if (!file) {
                alert('Please select an HTML file to convert.');
                return;
            }

            const formData = new FormData();
            formData.append('html_file', file);

            // Send a POST request to the server for conversion
            fetch('/upload', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.blob())
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    downloadLink.href = url;
                    downloadLink.download = 'output.docx';
                    downloadLink.style.display = 'block';

                    // Now, also load and display the HTML content
                    return fetch('/html-content');
                })
                .then(response => response.text())
                .then(htmlContent => {
                    htmlContentDiv.innerHTML = htmlContent;
                    htmlContentDiv.style.display = 'block';
                })
                .catch(error => console.error(error));
        });
    </script>
</body>

</html>